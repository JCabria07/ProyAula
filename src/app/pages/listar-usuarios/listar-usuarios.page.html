<ion-content fullscreen>
  <app-navbar></app-navbar>

  <div class="container py-4">

    <!-- Spinner -->
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-success" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-3">
        <i class="bi bi-hourglass-split me-2"></i>
        Cargando usuarios... Por favor espere
      </p>
    </div>

    <!-- Lista -->
    <div *ngIf="!loading">
      <h5 class="text-secondary mb-3">
        <i class="bi bi-people-fill me-2"></i> Usuarios registrados
      </h5>

      <ion-list>
        <ion-item *ngFor="let usuario of usuarios">
          <div slot="start">
            <i class="bi bi-person-circle fs-4"></i>
          </div>
          <ion-label>
            <h2>{{ usuario.nombre }}</h2>
            <p>
              <i class="bi bi-envelope me-1"></i>{{ usuario.correo }} •
              <i class="bi bi-person-badge me-1"></i>{{ usuario.rol }}
            </p>
          </ion-label>

          <!-- Botones -->
          <div class="d-flex gap-2 ms-3">
            <button class="btn btn-outline-warning btn-sm"
                    (click)="restablecerPassword(usuario)">
              <i class="bi bi-arrow-repeat me-1"></i> Restablecer contraseña
            </button>
            <button class="btn btn-outline-info btn-sm"
                    (click)="abrirModal(usuario)">
              <i class="bi bi-info-circle me-1"></i> Ver información
            </button>
          </div>
        </ion-item>
      </ion-list>

      <!-- Modal en HTML -->
      <div class="modal fade" tabindex="-1"
           [class.show]="modalAbierto"
           [style.display]="modalAbierto ? 'block' : 'none'">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">
                Información de {{ usuarioSeleccionado?.nombre }}
              </h5>
              <button type="button" class="btn-close" (click)="cerrarModal()"></button>
            </div>
            <div class="modal-body">
              <p><strong>Correo:</strong> {{ usuarioSeleccionado?.correo }}</p>
              <p><strong>Teléfono:</strong> {{ usuarioSeleccionado?.telefono }}</p>
              <p><strong>Rol:</strong> {{ usuarioSeleccionado?.rol }}</p>
              <p><strong>Identificación:</strong> {{ usuarioSeleccionado?.identificacion }}</p>
              <p><strong>Fecha creación:</strong> {{ usuarioSeleccionado?.fechaCreacion | date:'medium' }}</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cerrar</button>
            </div>
          </div>
        </div>
      </div>

      <app-footer></app-footer>
    </div>
  </div>
</ion-content>